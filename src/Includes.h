#pragma once

#include <ncurses.h>
#include <algorithm>
#include <memory>
#include <deque>
#include <vector>
#include <stdio.h>
#include <string>
#include <term.h>
#include <deque>
#include <iostream>
#include <memory>
#include <cassert>
#include <cstring>
#include <fstream>
#include <sstream>
#include <filesystem>

#include <chrono>
#include <thread>
#include <atomic>
#include <mutex>

#include <random>

#include <limits>

#include "Timer.h"

enum MODE
{
    INSERT_MODE,
    NORMAL_MODE,
    COMMAND_MODE,
    REPLACE_CHAR_MODE,
    VISUAL_MODE,
    VISUAL_LINE_MODE,
    VISUAL_BLOCK_MODE,
};

const int WHITESPACE_PER_TAB = 4;

enum YANK_TYPE
{
    LINE_YANK,
    BLOCK_YANK,
    VISUAL_YANK,
};

const int YANK_HIGHLIGHT_MILLISECONDS = 100;

enum CUSTOM_COLORS
{
    GREY = 8,
    RED = 9,
    LIME = 10,
    YELLOW = 11,
    BLUE = 12,
    FUCHSIA = 13,
    AQUA = 14,
    WHITE = 15,
    GREY0 = 16,
    NAVY_BLUE = 17,
    DARK_BLUE = 18,
    BLUE3_1 = 19,
    BLUE3_2 = 20,
    BLUE1 = 21,
    DARK_GREEN = 22,
    DEEP_SKY_BLUE4_1 = 23,
    DEEP_SKY_BLUE4_2 = 24,
    DEEP_SKY_BLUE4_3 = 25,
    DODGER_BLUE3 = 26,
    DODGER_BLUE2 = 27,
    GREEN4 = 28,
    SPRING_GREEN4 = 29,
    TURQUOISE4 = 30,
    DEEP_SKY_BLUE3_1 = 31,
    DEEP_SKY_BLUE3_2 = 32,
    DODGER_BLUE1 = 33,
    GREEN3_1 = 34,
    SPRING_GREEN3_1 = 35,
    DARK_CYAN = 36,
    LIGHT_SEA_GREEN = 37,
    DEEP_SKY_BLUE2 = 38,
    DEEP_SKY_BLUE1 = 39,
    GREEN3_2 = 40,
    SPRING_GREEN3_2 = 41,
    SPRING_GREEN2_1 = 42,
    CYAN3 = 43,
    DARK_TURQUOISE = 44,
    TURQUOISE2 = 45,
    GREEN1 = 46,
    SPRING_GREEN2_2 = 47,
    SPRING_GREEN1 = 48,
    MEDIUM_SPRING_GREEN = 49,
    CYAN2 = 50,
    CYAN1 = 51,
    DARK_RED_1 = 52,
    DEEP_PINK4_1 = 53,
    PURPLE4_1 = 54,
    PURPLE4_2 = 55,
    PURPLE3 = 56,
    BLUE_VIOLET = 57,
    ORANGE4_1 = 58,
    GREY37 = 59,
    MEDIUM_PURPLE4 = 60,
    SLATE_BLUE3_1 = 61,
    SLATE_BLUE3_2 = 62,
    ROYAL_BLUE1 = 63,
    CHARTREUSE4 = 64,
    DARK_SEA_GREEN4_1 = 65,
    PALE_TURQUOISE4 = 66,
    STEEL_BLUE = 67,
    STEEL_BLUE3 = 68,
    CORNFLOWER_BLUE = 69,
    CHARTREUSE3_1 = 70,
    DARK_SEA_GREEN4_2 = 71,
    CADET_BLUE_1 = 72,
    CADET_BLUE_2 = 73,
    SKY_BLUE3 = 74,
    STEEL_BLUE1_1 = 75,
    CHARTREUSE3_2 = 76,
    PALE_GREEN3_1 = 77,
    SEA_GREEN3 = 78,
    AQUAMARINE3 = 79,
    MEDIUM_TURQUOISE = 80,
    STEEL_BLUE1_2 = 81,
    CHARTREUSE2_1 = 82,
    SEA_GREEN2_1 = 83,
    SEA_GREEN1_1 = 84,
    SEA_GREEN1_2 = 85,
    AQUAMARINE1_1 = 86,
    DARK_SLATE_GRAY2 = 87,
    DARK_RED_2 = 88,
    DEEP_PINK4_2 = 89,
    DARK_MAGENTA_1 = 90,
    DARK_MAGENTA_2 = 91,
    DARK_VIOLET_1 = 92,
    PURPLE_1 = 93,
    ORANGE4_2 = 94,
    LIGHT_PINK4 = 95,
    PLUM4 = 96,
    MEDIUM_PURPLE3_1 = 97,
    MEDIUM_PURPLE3_2 = 98,
    SLATE_BLUE1 = 99,
    YELLOW4_1 = 100,
    WHEAT4 = 101,
    GREY53 = 102,
    LIGHT_SLATE_GREY = 103,
    MEDIUM_PURPLE = 104,
    LIGHT_SLATE_BLUE = 105,
    YELLOW4_2 = 106,
    DARK_OLIVE_GREEN3_1 = 107,
    DARK_SEA_GREEN_1 = 108,
    LIGHT_SKY_BLUE3_1 = 109,
    LIGHT_SKY_BLUE3_2 = 110,
    SKY_BLUE2 = 111,
    CHARTREUSE2_2 = 112,
    DARK_OLIVE_GREEN3_2 = 113,
    PALE_GREEN3_2 = 114,
    DARK_SEA_GREEN3_1 = 115,
    DARK_SLATE_GRAY3 = 116,
    SKY_BLUE1 = 117,
    CHARTREUSE1_1 = 118,
    LIGHT_GREEN_1 = 119,
    LIGHT_GREEN_2 = 120,
    PALE_GREEN1_1 = 121,
    AQUAMARINE1_2 = 122,
    DARK_SLATE_GRAY1 = 123,
    RED3_1 = 124,
    DEEP_PINK4_3 = 125,
    MEDIUM_VIOLET_RED = 126,
    MAGENTA3_1 = 127,
    DARK_VIOLET_2 = 128,
    PURPLE_2 = 129,
    DARK_ORANGE3_1 = 130,
    INDIAN_RED_1 = 131,
    HOT_PINK3_1 = 132,
    MEDIUM_ORCHID3_1 = 133,
    MEDIUM_ORCHID_1 = 134,
    MEDIUM_PURPLE2_1 = 135,
    DARK_GOLDENROD = 136,
    LIGHT_SALMON3_1 = 137,
    ROSY_BROWN = 138,
    GREY63 = 139,
    MEDIUM_PURPLE2_2 = 140,
    MEDIUM_PURPLE1_1 = 141,
    GOLD3_1 = 142,
    DARK_KHAKI = 143,
    NAVAJO_WHITE3 = 144,
    GREY69 = 145,
    LIGHT_STEEL_BLUE3 = 146,
    LIGHT_STEEL_BLUE = 147,
    YELLOW3_1 = 148,
    DARK_OLIVE_GREEN3_3 = 149,
    DARK_SEA_GREEN3_2 = 150,
    DARK_SEA_GREEN2_1 = 151,
    LIGHT_CYAN3 = 152,
    LIGHT_SKY_BLUE1 = 153,
    GREEN_YELLOW = 154,
    DARK_OLIVE_GREEN2_1 = 155,
    PALE_GREEN1_2 = 156,
    DARK_SEA_GREEN2_2 = 157,
    DARK_SEA_GREEN1_1 = 158,
    PALE_TURQUOISE1 = 159,
    RED3_2 = 160,
    DEEP_PINK3_1 = 161,
    DEEP_PINK3_2 = 162,
    MAGENTA3_2 = 163,
    MAGENTA3_3 = 164,
    MAGENTA2_1 = 165,
    DARK_ORANGE3_2 = 166,
    INDIAN_RED_2 = 167,
    HOT_PINK3_2 = 168,
    HOT_PINK2 = 169,
    ORCHID_1 = 170,
    MEDIUM_ORCHID1_1 = 171,
    ORANGE3 = 172,
    LIGHT_SALMON3_2 = 173,
    LIGHT_PINK3 = 174,
    PINK3 = 175,
    PLUM3 = 176,
    VIOLET = 177,
    GOLD3_2 = 178,
    LIGHT_GOLDENROD3 = 179,
    TAN = 180,
    MISTY_ROSE3 = 181,
    THISTLE3 = 182,
    PLUM2 = 183,
    YELLOW3_2 = 184,
    KHAKI3 = 185,
    LIGHT_GOLDENROD2_1 = 186,
    LIGHT_YELLOW3 = 187,
    GREY84 = 188,
    LIGHT_STEEL_BLUE1 = 189,
    YELLOW2 = 190,
    DARK_OLIVE_GREEN1_1 = 191,
    DARK_OLIVE_GREEN1_2 = 192,
    DARK_SEA_GREEN1_2 = 193,
    HONEYDEW2 = 194,
    LIGHT_CYAN1 = 195,
    RED1 = 196,
    DEEP_PINK2 = 197,
    DEEP_PINK1_1 = 198,
    DEEP_PINK1_2 = 199,
    MAGENTA2_2 = 200,
    MAGENTA1 = 201,
    ORANGE_RED1 = 202,
    INDIAN_RED1_1 = 203,
    INDIAN_RED1_2 = 204,
    HOT_PINK_1 = 205,
    HOT_PINK_2 = 206,
    MEDIUM_ORCHID1_2 = 207,
    DARK_ORANGE_1 = 208,
    SALMON1 = 209,
    LIGHT_CORAL = 210,
    PALE_VIOLET_RED1 = 211,
    ORCHID2 = 212,
    ORCHID1 = 213,
    ORANGE1 = 214,
    SANDY_BROWN = 215,
    LIGHT_SALMON1 = 216,
    LIGHT_PINK1 = 217,
    PINK1 = 218,
    PLUM1 = 219,
    GOLD1 = 220,
    LIGHT_GOLDENROD2_2 = 221,
    LIGHT_GOLDENROD2_3 = 222,
    NAVAJO_WHITE1 = 223,
    MISTY_ROSE1 = 224,
    THISTLE1 = 225,
    YELLOW1 = 226,
    LIGHT_GOLDENROD1 = 227,
    KHAKI1 = 228,
    WHEAT1 = 229,
    CORNSILK1 = 230,
    GREY100 = 231,
    GREY3 = 232,
    GREY7 = 233,
    GREY11 = 234,
    GREY15 = 235,
    GREY19 = 236,
    GREY23 = 237,
    GREY27 = 238,
    GREY30 = 239,
    GREY35 = 240,
    GREY39 = 241,
    GREY42 = 242,
    GREY46 = 243,
    GREY50 = 244,
    GREY54 = 245,
    GREY58 = 246,
    GREY62 = 247,
    GREY66 = 248,
    GREY70 = 249,
    GREY74 = 250,
    GREY78 = 251,
    GREY82 = 252,
    GREY85 = 253,
    GREY89 = 254,
    GREY93 = 255,
};

enum COLOR_PAIRS
{
    BACKGROUND = 1,

    LINE_NUMBER_ORANGE,
    LINE_NUMBER_GREY,

    NORMAL_MODE_PAIR,
    INSERT_MODE_PAIR,
    COMMAND_MODE_PAIR,
    REPLACE_CHAR_MODE_PAIR,
    VISUAL_MODE_PAIR,
    VISUAL_LINE_MODE_PAIR,
    VISUAL_BLOCK_MODE_PAIR,

    PATH_COLOR_PAIR,
    VISUAL_HIGHLIGHT_PAIR,
    ERROR_MESSAGE_PAIR,

    YANK_HIGHLIGHT_PAIR,
};

enum KEYS
{
    CTRL_C = 3,
    CTRL_D = 4,
    TAB = 9,
    ENTER = 10,
    CTRL_R = 18,
    CTRL_U = 21,
    CTRL_V = 22,
    CTRL_W = 23,
    ESCAPE = 27,
    SPACE = 32,
    QUOTE = 34,
    APOSTROPHE = 39,
    LEFT_PARENTHESIS = 40,
    COMMA = 44,
    COLON = 58,
    SEMICOLON = 59,
    LESS_THAN_SIGN = 60,
    GREATER_THAN_SIGN = 62,
    AT = 64,
    A = 65, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z,
    LEFT_BRACKET = 91,
    a = 97, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z,
    LEFT_BRACE = 123,
    SPACE_DOT = 250,
    BACKSPACE = 263,
};

const int JUMP_FORWARD = 0b001;
const int JUMP_BY_WORD = 0b010;
const int JUMP_TO_END = 0b100;

const int MAX_REPETITION_COUNT = 100000;

const size_t INPUT_CONTROLLER_MAX_CIRCULAR_BUFFER_SIZE = 10;
